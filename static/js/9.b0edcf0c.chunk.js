(this.webpackJsonptricorder=this.webpackJsonptricorder||[]).push([[9],{431:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return N}));var r=a(218),n=a.n(r),c=a(173),o=a(219),s=a(60),i=a(422),l=a(430),u=a(432),p=a(413),d=a(414),b=a(415),j=a(416),h=a(417),f=a(2),x=a(398),O=Object(x.a)({root:{background:"rgb(48, 63, 71)",boxSizing:"border-box"},header:{fontSize:"40px",color:"#FFFFFF",height:"100px"},patientId:{color:"#FFFFFF","& label":{fontSize:"24px !important",color:"#FFFFFF !important"},"& input":{marginTop:"8px",color:"#FFFFFF !important",fontSize:"36px !important"}},dropzone:{background:"rgba(44, 50, 53, 1)",height:"200px",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",color:"#6EC4D0",borderRadius:"16px","&.active":{background:"rgba(44, 50, 53, 0.5)"}},rows:{height:"calc(100vh - 400px)",overflowY:"auto"},row:{color:"#FFFFFF",fontSize:"18px",width:"80%",borderRadius:"5px",margin:"8px",padding:"8px","&.bg":{background:"#3B7B9C"}},dialogError:{color:"red"}}),m=Object(x.a)({root:{color:"#6EC4D0","&.MuiTypography-caption":{color:"#FFFFFF !important"}}}),F=a(153),g=a(370),v=a(11);function w(e){var t=e.onDropFiles,a=e.disabled,r=O(),c=Object(f.useCallback)(function(){var e=Object(o.a)(n.a.mark((function e(a){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=2;break}return e.abrupt("return");case 2:r=a.sort((function(e,t){return e.name>t.name?1:e.name<t.name?-1:0})),t(r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]),s=Object(g.a)({onDrop:c,disabled:a,multiple:!0,accept:[".dcm",".DCM"]}),l=s.getRootProps,u=s.getInputProps,p=s.isDragActive;return Object(v.jsx)(i.a,{display:"flex",justifyContent:"center",children:Object(v.jsxs)("div",Object(F.a)(Object(F.a)({},l()),{},{className:"".concat(r.dropzone," ").concat(p?"active":""),children:[Object(v.jsx)("input",Object(F.a)({},u())),Object(v.jsx)("p",{children:p?"Drop the files here ...":a?"Files processing, please wait for the current process finish":"Drag some files here, or click to select files"})]}))})}var k=a(409),y=a(412);function C(e){var t=m();return Object(v.jsxs)(i.a,{position:"relative",display:"inline-flex",children:[Object(v.jsx)(k.a,Object(F.a)(Object(F.a)({variant:"determinate"},e),{},{classes:{root:t.root}})),Object(v.jsx)(i.a,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",children:Object(v.jsx)(y.a,{variant:"caption",component:"div",style:{color:"#FFFFFF"},children:"".concat(Math.round(e.value),"%")})})]})}var S=a(351),D=a.n(S),z=a(49);function N(){var e=O(),t=Object(f.useState)(new URLSearchParams(window.location.search).get("patient_id")),a=Object(s.a)(t,2),r=a[0],x=a[1],m=Object(f.useState)(null),F=Object(s.a)(m,2),g=F[0],k=F[1],y=Object(f.useState)([]),S=Object(s.a)(y,2),N=S[0],I=S[1],P=Object(f.useState)(0),T=Object(s.a)(P,2),E=T[0],M=T[1],R=Object(f.useState)(!1),U=Object(s.a)(R,2),Y=U[0],B=U[1],J=Object(f.useState)(!1),A=Object(s.a)(J,2),K=A[0],L=A[1],_=Object(f.useCallback)((function(e){var t=Math.round(100*e.loaded/e.total);M(t)}),[]),q=Object(f.useCallback)((function(e){var t=e.map((function(e){return{filename:e.name,status:"pending"}}));I(t),B(!0),L(!1);try{D()({method:"post",url:"".concat(z.a,"/importer/").concat(r,"/start"),headers:{"Content-Type":"application/json"}})}catch(a){throw k("Failed to start the upload process, please try again."),a}}),[r]),G=Object(f.useCallback)(function(){var e=Object(o.a)(n.a.mark((function e(t){var a,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.a.mark((function e(a){var o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I((function(e){var t=Object(c.a)(e);return a>0&&(t[a-1].status="completed"),t[a].status="uploading",t})),(o=new FormData).append("dicom",t[a]),e.prev=3,e.next=6,D()({method:"post",url:"".concat(z.a,"/importer/").concat(r,"/dicom"),data:o,headers:{"Content-Type":"multipart/form-data"},onUploadProgress:_});case 6:e.next=13;break;case 8:throw e.prev=8,e.t0=e.catch(3),k("Upload file ".concat(t[a].name," failed. ").concat(e.t0.message)),M(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[3,8]])})),o=0;case 2:if(!(o<t.length)){e.next=7;break}return e.delegateYield(a(o),"t0",4);case 4:o++,e.next=2;break;case 7:I((function(e){var t=Object(c.a)(e);return t[e.length-1].status="completed",t}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[_,r]),H=Object(f.useCallback)(Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,D()({method:"post",url:"".concat(z.a,"/importer/").concat(r,"/end"),headers:{"Content-Type":"application/json"}});case 3:e.next=9;break;case 5:throw e.prev=5,e.t0=e.catch(0),k("Unfortunately, the upload process ended with error, please try again."),e.t0;case 9:B(!1),k("You have uploaded all the files.");case 11:case"end":return e.stop()}}),e,null,[[0,5]])}))),[r]),Q=Object(f.useCallback)(function(){var e=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q(t);case 3:return e.next=5,G(t);case 5:return e.next=7,H();case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),L(!0),console.error(e.t0);case 13:B(!1);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),[q,G,H]);return Object(v.jsxs)(i.a,{height:"100vh",p:"40px",className:e.root,children:[Object(v.jsx)("header",{className:e.header,children:Object(v.jsx)(l.a,{label:"Patient",value:r,classes:{root:e.patientId},onChange:function(e){return x(e.target.value)},error:!r})}),Object(v.jsx)(w,{onDropFiles:Q,disabled:!r||Y}),Object(v.jsxs)("section",{className:e.rows,children:[Object(v.jsx)("div",{className:e.row,children:"Filename - Status"}),N.map((function(t){return Object(v.jsxs)(i.a,{className:"".concat(e.row," bg"),display:"flex",justifyContent:"space-between",alignItems:"center",children:[Object(v.jsxs)("span",{children:[t.filename," - ",t.status," "]}),Object(v.jsx)("span",{children:"uploading"===t.status&&Object(v.jsx)(C,{value:E})})]},t.filename)}))]}),g&&Object(v.jsxs)(u.a,{open:!0,onClose:function(){return k(null)},children:[Object(v.jsxs)(p.a,{className:K?e.dialogError:"",children:[" ",K?"Oops!":"Congratulation!"]}),Object(v.jsx)(d.a,{children:Object(v.jsx)(b.a,{id:"alert-dialog-description",children:g})}),Object(v.jsx)(j.a,{children:Object(v.jsx)(h.a,{onClick:function(){return k(null)},color:"primary",children:"OK"})})]})]})}}}]);
//# sourceMappingURL=9.b0edcf0c.chunk.js.map